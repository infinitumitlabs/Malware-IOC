/*
   YARA Rule Set
   Author: Aziz Kaplan
   mail: aziz.kaplan@infinitumit.com.tr
   Date: 2023-10-10
  
*/


rule BunnyBotnet {
   meta:
      description = "Generic detection for BunnyBotnet"
      author = "Aziz Kaplan"
      date = "2023-10-10"
      hash1 = "55858d5ab444fa3d08f24287f7900deac0ed5b76781cfd97e6415452216e11cc"
      hash2 = "bbee98e1a45df6a04ff8f8c0de0550ad0baa91d873165bc20ce907302dba2c25"
      hash3 = "9ac43068071a2bca79ca02b68f3bdf1b6e432881af22d441361b3d54b1fbdc37"
      hash4 = "c15dbdd05315741d4099dc04f37e03f788ab65e4890b371016b8505fa6267558"
      hash5 = "fe325af53d8e401b7c8202e2e1d7638167341a68f70843c87d3ceff3d2bc5fba"
      hash6 = "3a1ccb42cbb712b9e6ca63ee9c4543b2c01907c068a0e199db7f2d864bee2b44"
      hash7 = "2847b80970c277b3d0368d671010fed71ebb3c2acc4c66dcfd3c14acba88e29b"
      ip = "37.139.129.145"
   strings:
	   $0 = /systeminfo \| findstr \/B \/C:"OS Name"/ nocase ascii wide
      $1 = "wmic /namespace:\\\\root\\SecurityCenter2 path AntiVirusProduct get displayName /value" fullword nocase wide ascii
	   $2 = "BunnyStealer" fullword nocase wide ascii
	   $3 = "Run Stealer" fullword nocase wide ascii
	   $4 = "powershell -Command \"Add-Type -A 'System.IO.Compression.FileSystem'; [System.IO.Compression.ZipFile]::CreateFromDirectory('" fullword nocase wide ascii
	   $5 = "------------------>BunnyLoader<--------------------" fullword nocase wide ascii
      $6 = "BunnyStealer" fullword nocase wide ascii
      $7 = "BunnyTasks" fullword nocase wide ascii
      $8 = "BunnyShell" fullword nocase wide ascii
      $9 = "BunnyRequester" fullword nocase wide ascii
      $10 = "http://37.139.129.145/Bunny/TaskHandler.php?CommandID=" fullword nocase wide ascii
      $11 = "http://37.139.129.145/Bunny/Echoer.php" fullword nocase wide ascii
      $12 = "http://37.139.129.145/Bunny/ResultCMD.php" fullword nocase wide ascii
      $13 = "http://37.139.129.145/Bunny/Heartbeat.php" fullword nocase wide ascii
      $14 = "http://37.139.129.145/Bunny/TaskHandler.php?BotID=" fullword nocase wide ascii
      $15 = "http://37.139.129.145/Bunny/StealerLogs/BunnyLogs_" fullword nocase wide ascii
      $16 = "http://37.139.129.145/Bunny/StealerRegistration.php?country=" fullword nocase wide ascii
      $17 = "[BunnyLoader ERROR] cgroup file not open" fullword nocase wide ascii
	  
   condition:  
      uint16(0) == 0x5a4d and filesize < 2MB and (
         7 of them
      )
}
