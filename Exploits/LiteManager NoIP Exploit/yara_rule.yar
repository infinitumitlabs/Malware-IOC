rule LiteManager_Exploit_Yara{
    meta: 
        description = "Yara rule for detecting LiteManager Exploit and variants"
        author = "Aziz Kaplan"
        email = "aziz.kaplan@infinitumit.com.tr"
        date = "2024-02-03"
        file_hash = "72e0fcfa4cf6766f88df74da16a71ac04e78f6219804037d9d3f1639a81ed066"
    strings:
        $1 = {e8 89 34 00 00 e9 89 fe ff ff 8b ff 55}
        $2 = {8b ec 81 ec 28 03 00 00 a3 78 60 41 00 89 0d 74 60 41 00}
        $3 = {89 15 70 60 41 00 89 1d 6c 60 41 00 89 35 68 60 41 00 89 3d 64 60 41 00}
        $4 = {66 8c 15 90 60 41 00 66 8c 0d 84 60 41 00 66 8c 1d 60 60 41 00}
        $5 = {66 8c 05 5c 60 41 00 66 8c 25 58 60 41 00 66 8c 2d 54 60 41 00 9c}
        $6 = {8d 84 24 34 01 00 00 50 8d 84 24 84 00 00 00 50 53 53 68 00 00 00 08}
        $7 = {6a 01 53 53 53 ff b4 24 48 01 00 00 ff 15 84 f0 40 00 eb 89} 
        $8 = {8d 44 24 3c 50 53 53 bf 00 00 00 08 57 6a 01 53 53 8d}
        $9 = {84 24 a8 08 00 00 50 8d 84 24 8c 01 00 00 50 ff d6}
        $10 = {8d 44 24 28 50 8d 44 24 3c 50 53 53 57 6a 01}
        $11 = {53 53 8d 84 24 88 01 00 00 50 50 ff d6}
        $12 = {ff 15 74 f0 40 00 8b f0}
        $13 = {8d 84 24 7c 01 00 00 50 6a 01 6a 02 6a 10 68 ff 01 0f 00}
        $14 = {ff b4 24 10 01 00 00 ff b4 24 10 01 00 00 ff 74 24 50 ff 15 14 f0 40 00}
        $15 = {8d 44 24 14 50 6a 01 56 ff 15 10 f0 40 00}
        $16 = {53 53 56 ff 15 0c f0 40 00 56}
        $17 = {8b 35 04 f0 40 00 ff d6 ff 74 24 20 ff d6}
        $18 = {8d 85 e4 fa ff ff 50 8d 85 f4 fd ff ff 50 89 b5 e4 fa ff ff ff 15 54 f0 40 00}
    condition:
        uint32(uint32(0x3C)) == 0x00004550 and all of them
}
