title: AMSI Bypass Zero Day Attack
id: 61d0475c-173f-4244-86f7-f3eebae1a66b

status: test
description: Detects the new AMSI Bypass Zero Day Attack
references:
    - https://github.com/infinitumitlabs/
    - https://infinitumit.com.tr
    - https://www.linkedin.com/company/infinitumlabs
author: Aziz Kaplan <aziz.kaplan@infinitumit.com.tr>
date: 2024/05/05
modified: 2024/05/06
tags:
    - attack.execution
    - attack.t1059.001
logsource:
    product: windows
    category: ps_script
detection:
    selection_cmdlet:
        ScriptBlockText|contains: 
            - 'currentdomain.getassemblies'
            - 'System.ComponentModel'
            - 'System.Management.Automation'
            - 'System.Reflection'
            - 'System.Runtime.CompilerServices'
            - 'System.Runtime.InteropServices'
            - 'MethodImplOptions.NoOptimization'
            - 'MethodImplOptions.NoInlining'
            - 'System.Reflection.BindingFlags'
            - 'MethodHandle.GetFunctionPointer'
            - 'System.Runtime.InteropServices.Marshal'
            - 'ReadProcessMemory'
            - 'GetCurrentProcess'
            - 'GetModuleHandle'
            - '.replace'
    condition:  all of selection_cmdlet
falsepositives:
    - Harmless PS1 Activity
level: high
