rule Zero_Day_AMSI_Bypass_Yara{
    meta: 
        description = "Yara rule for detecting new zero day AMSI Bypass method"
        author = "Aziz Kaplan"
        email = "aziz.kaplan@infinitumit.com.tr"
		date = "05.05.2024"
    strings:
        $OP_1 = {75 73 69 6E 67 20 53 79 73 74 65 6D 3B}
		$OP_2 = {75 73 69 6E 67 20 53 79 73 74 65 6D 2E 43 6F 6D 70 6F 6E 65 6E 74 4D 6F 64 65 6C}
		$OP_3 = {75 73 69 6E 67 20 53 79 73 74 65 6D 2E 4D 61 6E 61 67 65 6D 65 6E 74 2E 41 75 74 6F 6D 61 74 69 6F 6E}
		$OP_4 = {73 69 6E 67 20 53 79 73 74 65 6D 2E 52 65 66 6C 65 63 74 69 6F 6E}
		$OP_5 = {75 73 69 6E 67 20 53 79 73 74 65 6D 2E 52 75 6E 74 69 6D 65 2E 43 6F 6D 70 69 6C 65 72 53 65 72 76 69 63 65 73}
		$OP_6 = {75 73 69 6E 67 20 53 79 73 74 65 6D 2E 52 75 6E 74 69 6D 65 2E 49 6E 74 65 72 6F 70 53 65 72 76 69 63 65 73}
		$OP_7 = {30 78 35 30 30 30 30}
		$OP_8 = {30 78 31 30 30 30 30 30 30}
		$OP_9 = {52 65 61 64 50 72 6F 63 65 73 73 4D 65 6D 6F 72 79}
		$OP_10 = {47 65 74 43 75 72 72 65 6E 74 50 72 6F 63 65 73 73}
		$OP_11 = {47 65 74 50 72 6F 63 41 64 64 72 65 73 73}
		$OP_12 = {47 65 74 4D 6F 64 75 6C 65 48 61 6E 64 6C 65}
		$OP_13 = {4D 61 72 73 68 61 6C 41 73 28 55 6E 6D 61 6E 61 67 65 64 54 79 70 65 2E 4C 50 57 53 74 72}
		$OP_14 = {4D 65 74 68 6F 64 49 6D 70 6C 4F 70 74 69 6F 6E 73 2E 4E 6F 4F 70 74 69 6D 69 7A 61 74 69 6F 6E 20}
		$OP_15 = {4D 65 74 68 6F 64 49 6D 70 6C 4F 70 74 69 6F 6E 73 2E 4E 6F 49 6E 6C 69 6E 69 6E}
		$OP_16 = {63 75 72 72 65 6E 74 64 6F 6D 61 69 6E 2E 67 65 74 61 73 73 65 6D 62 6C 69 65 73 28}
		$OP_17 = {53 79 73 74 65 6D 2E 52 65 66 6C 65 63 74 69 6F 6E 2E 42 69 6E 64 69 6E 67 46 6C 61 67 73}
		$OP_18 = {4D 65 74 68 6F 64 48 61 6E 64 6C 65 2E 47 65 74 46 75 6E 63 74 69 6F 6E 50 6F 69 6E 74 65 72 28 29}
		$OP_19 = {53 79 73 74 65 6D 2E 52 75 6E 74 69 6D 65 2E 49 6E 74 65 72 6F 70 53 65 72 76 69 63 65 73 2E 4D 61 72 73 68 61}
    condition:
		all of them
}
