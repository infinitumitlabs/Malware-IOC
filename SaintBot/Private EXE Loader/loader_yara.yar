rule Private_EXE_Loader_Yara{
    meta: 
      description = "Yara rule for detecting Private EXE Loader"
      author = "Aziz Kaplan"
      email = "aziz.kaplan@infinitumit.com.tr"
      file_hash = "d08243e976e01baa5479a134577a1407daf4bec89a5f47bf2b803c0919917f5b"
    strings:
      $1 = {64 00 6c 00 6c 00 20 00 68 00 6f 00 73 00 74 00 00 00}
      $2 = {57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 20 00 64 00 6c 00 6c 00 20 00 68 00 6f 00 73 00 74}
      $3 = { 57 00 69 00 6e 00 64 00 6f 00 77 00 73 00 44 00 6f 00 77 00 6e 00 6c 00 6f 00 61 00 64 00 4d}
      $4 = {00 61 00 6e 00 61 00 67 00 65 00 72 00 2e 00 65 00 78 00 65 00 00 00  }
      $5 = { 1b 30 08 00 b2 00 00 00 01 00 00 11  }
      $6 = { 00 02 28 4f 00 00 06 25 26 0a 2b 00 06 2a  }
      $7 = { 04 2c 68 19 45 01 00  }
      $8 = { 11 08 11 05 11 08 9a 6f  }
      $9 = { 13 08 11 08 11 06  }
      $10 =  { 28 9a 00 00 06 25 26 13 07  }
      $11 = {00 02 03 28 30 01 00 06 25 26 0a 2b 00 06 2a  }
      $12 = { 00 02 28 fc 00 00 06 25 26 0a 2b 00 06 2a  }
      $13 = { ff 25 00 20 40 00  }
      $14= { 1b 30 08 00 b2 00 00 00 01 00 00 11  }
    condition:
        uint32(uint32(0x3C)) == 0x00004550 and 7 of them
}